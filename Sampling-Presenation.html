<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Sampling Plans and Analysis for Loan Data </title>
    <meta charset="utf-8" />
    <meta name="author" content=" Jaiden Neff " />
    <script src="Sampling-Presenation_files/header-attrs/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer01.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# <font size = 7 color = "White">Sampling Plans and Analysis for Loan Data </font>
]
.author[
### <font size = 5 color = "White"> Jaiden Neff </font>
]
.institute[
### <font size = 6 color = "White">West Chester University of Pennsylvania</font><br>
]

---







&lt;h2 align="center"&gt; Table of Contents&lt;/h2&gt;
&lt;BR&gt;

.pull-left[
- Data Description 
- Data Cleaning
   - Description of FRR 
- Sampling Description
- Loan Default Rate 
- Study Population 
- Simple Random Sample  
- Systematic Sample
- Stratified Sample
- Custer Sample
- Default Rate 
- Plot/ Visual Comparison 
- Final Thoughts
]



---

&lt;h2 align="center"&gt; Data Description &lt;/h2&gt;

![](datainfo1.png)          

---
&lt;h2 align="center"&gt; Data Description &lt;/h2&gt;

![](datainfo2.png) 
---

&lt;h2 align="center"&gt; Data Cleaning &lt;/h2&gt;

- Removed all missing values from MIS_Status
- Converted Dollar amount to a numeric variable
- Wanted to make the info more useful in bank states
- Took all of the bank states and break them down into the category of Federal Reserve Region 
- Brake up allows us to look at 12 distinct categories instead of 50 
- 598,499 observations after cleaning 


---

&lt;h2 align="center"&gt; Federal Reserve Regions &lt;/h2&gt;

Boston: Connecticut (CT), Maine (ME), Massachusetts (MA), New Hampshire (NH), Rhode Island (RI), Vermont (VT)

New York: New Jersey (NJ), New York (NY)

Philadelphia: Pennsylvania (PA)

Richmond: Delaware (DE), District of Columbia (DC), Maryland (MD), Virginia (VA), West Virginia (WV)

Atlanta: Alabama (AL), Florida (FL), Georgia (GA), North Carolina (NC), South Carolina (SC)

St. Louis: Kentucky (KY), Louisiana (LA), Mississippi (MS), Tennessee (TN)

Chicago: Illinois (IL), Indiana (IN), Iowa (IA), Michigan (MI), Minnesota (MN), Wisconsin (WI)

Dallas: Arkansas (AR), Missouri (MO), Oklahoma (OK), Texas (TX)

Kansas City: Colorado (CO), Montana (MT), Utah (UT), Wyoming (WY), Ohio (OH), North Dakota (ND), South Dakota (SD), Nebraska (NE), Kansas (KS)

San Francisco: Arizona (AZ), California (CA), Hawaii (HI), Nevada (NV)

Seattle: Alaska (AK), Idaho (ID), Oregon (OR), Washington (WA)

Other: States not listed in the above breakdown


---

&lt;h2 align="center"&gt; Sampling Type Description &lt;/h2&gt;

#### Simple Random Sampling (SRS):

- Equal Chance of selection
- Each selection is independent from each other

Why use it: 
- Ensures equal chance of selection 
- Avoid bias more representative of population as a whole 


#### Systematic Sampling:

- Involves selecting every k-th element from a list or sampling frame
- (k) is determined based on the desired sample size and the size of the population
 
Why use it:
- Simple and more effective than SRS, Ensures sample is spread evenly across population
- It's useful when there's a list or sequence of elements from which to sample, such as customer lists or patient records


---

&lt;h2 align="center"&gt; Sampling Type Description &lt;/h2&gt;


#### Stratified Sampling: 

- The population is divided into distinct subgroups or strata based on certain characteristics
- Samples are then independently drawn from each stratum

Why use it: 
- Ensures that each subgroup is proportionally represented in the sample 
- Improve the precision of estimates, especially when certain subgroups are underrepresented


#### Cluster Sampling:

- The population is divided into clusters or groups, A random sample of clusters is selected
- All individuals within the selected clusters are included in the sample
 
Why use it: 
- Can be more practical and cost-effective when it's difficult or impractical to sample individuals directly
- Useful when the population is geographically dispersed 
- Useful when it's easier to access clusters rather than individuals directly.

---

&lt;h2 align="center"&gt; Sampling Visual &lt;/h2&gt;

Here you can see a better representation of what happens in each sampling method.  


![](SamplingPlans.png)


---

--- 

&lt;h2 align="center"&gt; Loan Default Rates &lt;/h2&gt;

Here We find the loan default rates by region defined by the stratification variable Federal Reserve region. The loan default status can be defined by the variable MIS_Status.





|              |FederalReserveRegion | NoDefault| Default| DefaultRate|
|:-------------|:--------------------|---------:|-------:|-----------:|
|Atlanta       |Atlanta              |     64135|   24604|        27.7|
|Boston        |Boston               |     46260|    9476|        17.0|
|Chicago       |Chicago              |     71433|   17331|        19.5|
|Dallas        |Dallas               |     41003|    7529|        15.5|
|Kansas City   |Kansas City          |     93528|   18230|        16.3|
|New York      |New York             |     26257|    5939|        18.4|
|Other         |Other                |      3588|     352|         8.9|
|Philadelphia  |Philadelphia         |      9893|     929|         8.6|
|Richmond      |Richmond             |     30785|   14272|        31.7|
|San Francisco |San Francisco        |     62159|   19218|        23.6|
|Seattle       |Seattle              |     15154|    2883|        16.0|
|St. Louis     |St. Louis            |     11729|    1812|        13.4|

---

&lt;h2 align="center"&gt; Study Population &lt;/h2&gt;

Here the categories "Other" and "Philadelphia" are removed because they are much smaller in comparison to the other categories and the default rates show us that it could create an issue later 


| Atlanta| Boston| Chicago| Dallas| Kansas City| New York| Philadelphia| Richmond| San Francisco| Seattle| St. Louis|
|-------:|------:|-------:|------:|-----------:|--------:|------------:|--------:|-------------:|-------:|---------:|
|   88739|  55736|   88764|  48532|      111758|    32196|        10822|    45057|         81377|   18037|     13541|



|   Size|   |
|------:|--:|
| 594559| 30|


---

&lt;h2 align="center"&gt; Simple Random Sample &lt;/h2&gt;


Here we take the simple random sample of the study population and are given a random sample of 4000 loan applications.


| Size| Var.count|
|----:|---------:|
| 4000|        31|



---

&lt;h2 align="center"&gt; Systematic Sample &lt;/h2&gt;

- Similarly we take a systematic sample and get a sample size of around 4000

- Randomized start value

- Jump size of 145


| Size| Var.count|
|----:|---------:|
| 4017|        31|

---

&lt;h2 align="center"&gt; Stratified Sample &lt;/h2&gt;


Here we take a stratified sample using the Federal reserve region that was added to this data set. We are able to see the break down of a sample of 4000 using the federal reserve regions to explain the data 




| Atlanta| Boston| Chicago| Dallas| Kansas City| New York| Philadelphia| Richmond| San Francisco| Seattle| St. Louis|
|-------:|------:|-------:|------:|-----------:|--------:|------------:|--------:|-------------:|-------:|---------:|
|     597|    375|     597|    327|         752|      217|           73|      303|           547|     121|        91|




```
## 'data.frame':	594559 obs. of  31 variables:
##  $ VAR1                : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ LoanNr_ChkDgt       : num  1e+09 1e+09 1e+09 1e+09 1e+09 ...
##  $ Name                : chr  "ABC HOBBYCRAFT" "LANDMARK BAR &amp; GRILLE (THE)" "WHITLOCK DDS, TODD M." "BIG BUCKS PAWN &amp; JEWELRY, LLC" ...
##  $ City                : chr  "EVANSVILLE" "NEW PARIS" "BLOOMINGTON" "BROKEN ARROW" ...
##  $ State               : chr  "IN" "IN" "IN" "OK" ...
##  $ Zip                 : int  47711 46526 47401 74012 32801 6062 7083 34491 32456 6073 ...
##  $ Bank                : chr  "FIFTH THIRD BANK" "1ST SOURCE BANK" "GRANT COUNTY STATE BANK" "1ST NATL BK &amp; TR CO OF BROKEN" ...
##  $ BankState           : chr  "OH" "IN" "IN" "OK" ...
##  $ NAICS               : int  451120 722410 621210 0 0 332721 0 811118 721310 0 ...
##  $ ApprovalDate        : chr  "28-FEB-1997" "28-FEB-1997" "28-FEB-1997" "28-FEB-1997" ...
##  $ ApprovalFY          : int  1997 1997 1997 1997 1997 1997 1980 1997 1997 1997 ...
##  $ Term                : int  84 60 180 60 240 120 45 84 297 84 ...
##  $ NoEmp               : int  4 2 7 2 14 19 45 1 2 3 ...
##  $ NewExist            : int  2 2 1 1 1 1 2 2 2 2 ...
##  $ CreateJob           : int  0 0 0 0 7 0 0 0 0 0 ...
##  $ RetainedJob         : int  0 0 0 0 7 0 0 0 0 0 ...
##  $ FranchiseCode       : int  1 1 1 1 1 1 0 1 1 1 ...
##  $ UrbanRural          : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ RevLineCr           : chr  "N" "N" "N" "N" ...
##  $ LowDoc              : chr  "Y" "Y" "N" "Y" ...
##  $ ChgOffDate          : chr  "" "" "" "" ...
##  $ DisbursementDate    : chr  "28-FEB-1999" "31-MAY-1997" "31-DEC-1997" "30-JUN-1997" ...
##  $ MIS_Status          : chr  "P I F" "P I F" "P I F" "P I F" ...
##  $ nDisbursementGross  : int  60000 40000 287000 35000 229000 517000 600000 45000 305000 70000 ...
##  $ nBalanceGross       : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ nChgOffPrinGr       : int  0 0 0 0 0 0 208959 0 0 0 ...
##  $ nGrAppv             : int  60000 40000 287000 35000 229000 517000 600000 45000 305000 70000 ...
##  $ nSBA_Appv           : int  48000 32000 215250 28000 229000 387750 499998 36000 228750 56000 ...
##  $ FederalReserveRegion: chr  "Kansas City" "Chicago" "Chicago" "Dallas" ...
##  $ DefaultStatus       : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ sampling.frame      : int  1 2 3 4 5 6 7 8 9 10 ...
```

---

&lt;h2 align="center"&gt; Cluster Sample  &lt;/h2&gt;


- Here we are using the cluster sampling method we are using Zip codes to break up the data into clusters when we look we can see we created 29880 clusters

- Randomly select 4000 clusters 


```
## 1 - level Cluster Sampling design (with replacement)
## With (29880) clusters.
## svydesign(ids = ~Zip, data = loan2)
```

```
##           mean     SE
## nGrAppv 191544 893.47
```

### Verifying 

To verify this is correct we look at the 29880 clusters with the amount of unique zip codes there are in this data set


```
## [1] 29880
```

---

&lt;h2 align="center"&gt; Default Rates  &lt;/h2&gt;

















|              | default.rate.pop| default.rate.srs| default.rate.sys| default.rate.str|
|:-------------|----------------:|----------------:|----------------:|----------------:|
|Atlanta       |             27.7|             29.3|             28.7|             27.3|
|Boston        |             17.0|             17.6|             20.9|             16.8|
|Chicago       |             19.5|             20.7|             17.6|             19.3|
|Dallas        |             15.5|             13.5|             18.0|             16.2|
|Kansas City   |             16.3|             16.1|             16.4|             14.6|
|New York      |             18.4|             17.1|             18.1|             17.5|
|Philadelphia  |              8.6|             11.0|              6.3|              4.1|
|Richmond      |             31.7|             29.2|             35.3|             33.0|
|San Francisco |             23.6|             24.4|             22.6|             22.7|
|Seattle       |             16.0|             13.3|             17.8|             14.0|
|St. Louis     |             13.4|             17.0|             12.6|             15.4|
---

&lt;h2 align="center"&gt; Plotting the Default Rates &lt;/h2&gt;



&lt;img src="Sampling-Presenation_files/figure-html/unnamed-chunk-15-1.png" width="100%" /&gt;



---


&lt;h2 align="center"&gt; Final Thoughts &lt;/h2&gt;


- After reviewing the data and the different sampling methods I think that though the sampling methods are all effective
- The stratified sample and the simple random sample have closer default rates to the total population overall. - We can see in the graphic that the stratified sample follows the line more closely then the other sampling methods. 
- For this reason and for the proportion that is left up to chance when using SRS I think that a stratified sample would be the most effective to use in our loan study. 




---

&lt;h2 align="center"&gt; Thank you! &lt;/h2&gt;




    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
